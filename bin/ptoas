#!/usr/bin/env bash
set -euo pipefail
os=$(uname -s)
arch=$(uname -m)

case "${os}:${arch}" in
  Linux:aarch64|Linux:arm64) subdir="linux-aarch64" ;;
  Linux:x86_64|Linux:amd64) subdir="linux-x86_64" ;;
  Darwin:arm64) subdir="macos-aarch64" ;;
  *)
    echo "error: unsupported platform: ${os} ${arch}" >&2
    exit 2
    ;;
esac

exe="$(cd "$(dirname "$0")" && pwd)/${subdir}/ptoas"
if [[ ! -x "$exe" ]]; then
  echo "error: ptoas binary not found or not executable: $exe" >&2
  exit 2
fi
exec "$exe" "$@"
